# 8장. 메서드

[https://www.notion.so/8-23323d237df74d94b47c3349dd38c3d9](https://www.notion.so/8-23323d237df74d94b47c3349dd38c3d9)

> 요약 : 메서드 뿐 아니라, 생성자에서 매개변수와 반환 값을 어떻게 처리해야하는지 메서드 시그니처는 어떻게 설계해야하는 지, 문서화는 어떻게 해야하는 지를 다룬다.
키워드 : 사용성 견고성 유연성

# 아이템 49. 매개변수가 유효한지 검사하라.

메서드와 생성자 대부분은 입력 매개변수의 값이 특정 조건을 만족하기를 바란다.

ex) 인덱스 값은 음수이면 안되며, 객체 참조는 null이 아니어야 하는 식.

⇒ 메서드 몸체가 실행되기 전에 매개변수를 확인하는 습관을 들여야 한다.

⇒ public, protected 메서드는 매개변수 값이 잘못됐을 때 던지는 예외를 문서화해두도록 한다.

(@throws 태그 사용, ex) IllegalArgumentException, IndexOutOfBoundsException,NullPointerException)

@Nullable이나 비슷한 메서드를 사용해, null이 될 수도 있다고 알려줄 수 있지만 표준적인 방법은 아니다.

자바 7 에 추가 : java.util.objects.requireNomNull 메서드 

자바 9 에 추가 : Objects에 범위 검사 기능 : checkFromIndexSize, checkFromToIndex, checkIndex 메서드

public이 아닌 메서드에서는 단언문 assert를 사용해 매개변수 유효성을 검증할 수 있다. 

: 실패하면 AssertionError

# 아이템 50. 적시에 방어적 복사본을 만들라

늘. 클라이언트가 불변식을 깨트리려 혈안이 되어 있다고 가정하고 방어적으로 프로그래밍 해야 한다.

Date는 가변이기때문에 생성자에 사용하는 걸 주의해야 한다.

대신 Instant나, LocalDateTine, ZonedDateTime을 사용해도 된다. (불변)

매개변수의 유효성을 검사하기전에 방어적 복사본을 만들고, 이 복사본으로 유효성을 검사하자.

멀티스레딩 환경이라면 원본 객체의 유효성을 검사한 후 복사본을 만드는 그 찰나의 취약한 순간에 다른 스레드가 원본 객체를 수정할 위험이 있기때문이다.

*방어적 복사본을 만들 때 clone을 사용하지 않게 주의하자.(생성자와 달리 접근자 메서드에서는 방어적 복사에 clone을 사용해도 된다.)

# 아이템 51. 메서드 시그니처를 신중하게 설계하라

- 메서드 이름을 신중히 짓자
- 편의 메서드를 너무 많이 만들지 말자
- 매개변수 목록은 짧게 유지하자.
    1. 여러메서드로 쪼갠다.
    2. 매개변수 여러 개를 묶어주는 도우미 클래스를 만드는 것이다. 
    3. 세번째는 앞서의 두 기법을 혼합한 것으로, 객체 생성에 사용한 빌더 패턴을 메서드 호출에 응용한다고 보면 된다. 

# 아이템 52. 다중정의는 신중히 사용하라

사진.

- 실제로 수행해보면 "그 외"만 연달아 출력한다.

다중정의 된 세 classify중 어느 메서드를 호출할지가 컴파일 타임에 정해지기 때문이다.

컴파일 타임에는 for 문 안의 c는 항상 Collection<?> 타입이다. 

런타임에는 타입이 매번 달라지지만, 호출할 메서드를 선택하는 데는 영향을 주지 못 한다.

재정의한 메서드는 동적으로 선택되고, 다중 정의한 메서드는 정적으로 선택되기 때문이다.

### 대체안 1. 재정의 메서드

메서드를 재정의한 다음 "하위클래스의 인스턴스"에서 그 메서드를 호출하면 재정의한 메서드가 실행된다.

사진

>> "포도주", "발포성 포도주", "샴페인" >> 재정의한 메서드 

### 대체안2. instanceof

안전하고 보수적으로 가려면 매개변수 수가 같은 다중정의는 만들지 않는게 좋으며, 다중정의하는 대신 메서드 이름을 다르게 지어주는 길도 항상 열려 있다.

# 53. 가변 인수는 신중히사용하라.

가변인수 메서드는 명시한 타입의 인수를 0개 이상 받을 수 있다.

```java
int.. args
```

이럴 경우엔 위험을 대비하기 위해, 첫번째는 평범한 매개변수로, 가변인수는 두번째로 받으면 문제가 사라진다

```java
static int min(int firsrArg, int... remainingArgs)
```

인수 개수가 일정하지 않은 메서드를 정의해야 한다면 가변인수가 반드시 필요하다.

메서드를 정의할 때 필수 매개변수는 가변인수 앞에 두고, 가변인수를 사용할 때는 성능문제까지 고려하자.

# 아이템 54. null이 아닌, 빈 컬렉션이나 배열을 반환하라

null이 낫다의 주장도 있으나.

1. 성능 분석 결과 이 할달이 성능 저하의 주범이라고 확인되지 않는 한데 이 정도의 성능 차이는 신경 쓸 수준이 못된다.
2. 빈 컬렉션과 배열은 굳이 새로 할당하지 않고도 반환할 수 있다.

빈 컬렉션 반환

```java
return new ArrayList<>(cheesesInStock);
```

Collections.empyList, Collections.emptySet, Collections.emptyMap 을 사용하면 된다.

배열을 쓸 때도 null을 반환하지 말고 길이가 0인 배열을 반환하라.

# 아이템 55. 옵셔널 반환은 신중히 하라

Optional<T> : null 이 아닌 T 타입 참조를 하나 담거나, 혹은 아무것도 담지 않을 수 있다. 

옵셔널은 원소를 최대 1개 가질 수 있다는 '불변'컬렉션이다.

유효한 반환값이 없을 때는 빈 결과를 반환하는 메서드가 만들어진다.

컬렉션, 스트림, 배열,옵셔널 같은 컨테이너 타입은 옵셔널로 감싸면 안된다.

빈 optional을 반환하기보다는 빈 List<T>를 반환하는 게 좋다.

# 아이템 56. 공개된 API 요소에는 항상 문서화 주석을 작성하라.

API를 올바로 문서화 하려면 공개된 모든 클래스, 인터페이스, 메서드, 필드 선언에 문서화 주석을 달아야 한다.

빠짐없이 설명을 달아야 한다.